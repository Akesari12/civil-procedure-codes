---
title: "Network graphs in ggraph"
author: "Lincoln Mullen"
---

```{r setup, include=TRUE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(igraph)
library(ggplot2)
library(ggraph)
library(stringr)
load("cache/corpus-lsh.rda")
load("cache/network-graphs.rda")
source("R/helper.R")
set.seed(82892)
```

The network graphs aren't very pretty so far, so we are going to see if we can do better in [ggraph](https://github.com/thomasp85/ggraph).


```{r}
ggraph(codes_g, "igraph", algorithm = "nicely") +
  geom_edge_fan(aes(edge_width = sections_borrowed, 
                    alpha = sections_borrowed),
                arrow = arrow(type = "closed", ends = "first",
                              length = unit(0.20, "inches"),
                              angle = 15)) +
  geom_node_point(aes(colour = as.factor(distance)), size = 6) +
  scale_edge_width("Sections borrowed", range = c(1, 2), guide = "none") + 
  scale_edge_alpha(range = c(0.3, 0.6), guide = "none") +
  scale_color_discrete("Distance from a NY code") +
  ggforce::theme_no_axes() +
  geom_node_text(aes(label = name)) +
  labs(title = "Code to code borrowings") +
  theme(legend.position = "bottom")
```

Now make a plot of state to state borrowings.

```{r}
ggraph(states_g, "igraph", algorithm = "nicely") +
  geom_edge_fan(aes(edge_width = sections_borrowed, 
                    alpha = sections_borrowed),
                arrow = arrow(type = "closed", ends = "first",
                              length = unit(0.20, "inches"),
                              angle = 15)) +
  geom_node_point(size = 6, alpha = 0.75, aes(color = region)) +
  geom_node_text(aes(label = name)) +
  scale_edge_width("Sections borrowed", range = c(1, 2), guide = "none") + 
  scale_edge_alpha(range = c(0.3, 0.4), guide = "none") +
  ggforce::theme_no_axes() +
  labs(title = "State to state borrowings") +
  theme(legend.position = "bottom")
```


